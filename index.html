<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chatbot Coze</title>
<style>
    body {
        font-family: Arial, sans-serif;
    }
    .chat-container {
        max-width: 500px;
        margin: 20px auto;
        border: 1px solid #ccc;
        border-radius: 5px;
        overflow: hidden;
    }
    .chat-header {
        background-color: #007bff;
        color: #fff;
        padding: 10px;
        text-align: center;
    }
    .chat-messages {
        max-height: 300px;
        overflow-y: auto;
        padding: 10px;
    }
    .user-message {
        background-color: #e1ffc7;
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 5px;
        align-self: flex-end;
    }
    .bot-message {
        background-color: #f1f1f1;
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 5px;
        align-self: flex-start;
    }
    .message {
        max-width: 70%;
        word-wrap: break-word;
    }
    .message-content {
        font-size: 16px;
    }
    .message-time {
        font-size: 12px;
        color: #666;
    }
    .chat-input {
        display: flex;
        align-items: center;
        padding: 10px;
        border-top: 1px solid #ccc;
    }
    .input-field {
        flex: 1;
        padding: 8px;
        margin-right: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    .send-button {
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 8px 16px;
        cursor: pointer;
    }
</style>
</head>
<body>
<div class="chat-container">
    <div class="chat-header">Chatbot Coze</div>
    <div class="chat-messages" id="chatMessages">
        <!-- Chat messages will be added dynamically here -->
    </div>
    <div class="chat-input">
        <input type="text" class="input-field" id="userInput" placeholder="Type your message...">
        <button class="send-button" onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
    const accessToken = 'pat_4RRRsN1HkKSj3ciVTrqzzO8BRltdaeFlMQCA8cFqt2HYMMZ3q0DbhyxIYmqe6Zzm';
    const botId = '7348640557197246482';
    const chatMessages = document.getElementById('chatMessages');

    function sendMessage() {
        const userInput = document.getElementById('userInput').value.trim();
        if (userInput !== '') {
            addMessage(userInput, 'user-message');

            fetch('https://api.coze.com/open_api/v2/chat', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${accessToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    bot_id: botId,
                    query: userInput
                })
            })
            .then(response => response.json())
            .then(data => {
                const botMessage = data?.message?.content;
                if (botMessage) {
                    addMessage(botMessage, 'bot-message');
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });

            document.getElementById('userInput').value = '';
        }
    }

    function addMessage(message, className) {
        const messageDiv = document.createElement('div');
        messageDiv.classList.add('message', className);
        messageDiv.innerHTML = `
            <div class="message-content">${message}</div>
            <div class="message-time">${formatTime(new Date())}</div>
        `;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function formatTime(date) {
        const hours = date.getHours();
        const minutes = date.getMinutes();
        return `${hours}:${minutes < 10 ? '0' : ''}${minutes}`;
    }
</script>
</body>
</html>
